<!DOCTYPE html>
<html>
<head>
    <title>Playlist</title>
    <!-- Correct Flask static CSS link -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<h1>ğŸ“‚ Playlist: {{ playlist_name }}</h1>

<p style="text-align:center;">
    <a href="/">â¬… Back Home</a>
</p>

<div class="grid">
    {% for video in videos %}
    <div class="card">

        <img class="thumb" src="{{ url_for('static', filename='thumbs/' + video.thumbnail) }}"
             onclick="playVideo('{{ video.filename }}')">

        <div style="padding:10px;">
            <video id="player-{{ video.filename }}" class="video-player" controls style="display:none;"
                   onplay="addView('{{ video.filename }}')">
                <source src="{{ url_for('static', filename='uploads/' + video.filename) }}">
            </video>
        </div>

        <div class="title">{{ video.title }}</div>
        <div class="desc">{{ video.description }}</div>

        <div class="stats">
            <form method="POST" action="/heart/{{ video.filename }}">
                <button class="heart-btn">â¤ï¸ {{ video.hearts }}</button>
            </form>

            <div>ğŸ‘ {{ video.views }}</div>

            <a class="download-btn" href="/download/{{ video.filename }}">â¬‡ Download</a>

            <form method="POST" action="/delete/{{ video.filename }}"
                  onsubmit="return confirm('Delete this video?');">
                <button class="delete-btn">ğŸ—‘</button>
            </form>
        </div>

        <div class="date">
            Uploaded: {{ video.pretty_date }}
        </div>

    </div>
    {% endfor %}
</div>

<script>
    function addView(filename) {
        fetch("/view/" + filename, { method: "POST" });
    }

    function playVideo(filename) {
        let player = document.getElementById("player-" + filename);
        if (player.style.display === "none") {
            player.style.display = "block";
            player.play();
        } else {
            player.pause();
            player.style.display = "none";
        }
    }
</script>

</body>
</html>