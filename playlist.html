<!DOCTYPE html>
<html>
<head>
    <title>Playlist</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>ğŸ“‚ Playlist: {{ playlist_name }}</h1>

<p style="text-align:center;">
    <a href="index.html">â¬… Back Home</a>
</p>

<div class="grid">
    {% for video in videos %}
    <div class="card">

        <img class="thumb"
             src="{{ video.thumb_url }}"
             onclick="playVideo('{{ video.public_id }}')">

        <div style="padding:10px;">
            <video id="player-{{ video.public_id }}" class="video-player" controls style="display:none;"
                   onplay="addView('{{ video.public_id }}')">
                <source src="{{ video.video_url }}">
            </video>
        </div>

        <div class="title">{{ video.title }}</div>
        <div class="desc">{{ video.description }}</div>

        <div class="stats">
            <form method="POST" action="/heart/{{ video.public_id }}">
                <button class="heart-btn">â¤ï¸ {{ video.hearts }}</button>
            </form>

            <div>ğŸ‘ {{ video.views }}</div>

            <form method="POST" action="/delete/{{ video.public_id }}"
                  onsubmit="return confirm('Delete this video?');">
                <button class="delete-btn">ğŸ—‘</button>
            </form>
        </div>

        <div class="date">
            Uploaded: {{ video.pretty_date }}
        </div>

    </div>
    {% endfor %}
</div>

<script>
    function addView(public_id) {
        fetch("/view/" + public_id, { method: "POST" });
    }

    function playVideo(public_id) {
        let player = document.getElementById("player-" + public_id);

        if (player.style.display === "none") {
            player.style.display = "block";
            player.play();
        } else {
            player.pause();
            player.style.display = "none";
        }
    }
</script>

</body>
</html>